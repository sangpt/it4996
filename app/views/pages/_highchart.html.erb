var chart_number_requests = {
  chart: {
    type: 'column'
  },
  title: {
    text: 'Number of Requests chart'
  },
  subtitle: {
    text: 'By number of Requests'
  },
  xAxis: {
    categories: <%= data.keys.map(&:to_s).to_s.html_safe %>,
    crosshair: true
  },
  yAxis: {
    min: 0,
    title: {
      text: 'Requests'
    }
  },
  tooltip: {
    headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
    pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' + '<td style="padding:0"><b>{point.y:.1f} requests</b></td></tr>',
    footerFormat: '</table>',
    shared: true,
    useHTML: true
  },
  plotOptions: {
    column: {
      pointPadding: 0.2,
      borderWidth: 0
    }
  },
  series: [
    {
      name: 'Number of requests',
      data: <%= data.values.map &:count %>
    }
  ]
};

var chart_average_duration = {
  chart: {
      type: 'column'
  },
  title: {
      text: 'Total success or error request'
  },
  xAxis: {
      categories: <%= data.keys.map(&:to_s).to_s.html_safe %>
  },
  yAxis: {
      min: 0,
      title: {
          text: 'Percent'
      }
  },
  tooltip: {
      pointFormat: '<span style="color:{series.color}">{series.name}</span>: <b>{point.y}</b> ({point.percentage:.0f}%)<br/>',
      shared: true
  },
  plotOptions: {
      column: {
          stacking: 'percent'
      }
  },
  series: [{
      name: 'Success',
      data: <%= data.values.map {|e| e.select(&:success?).count} %>
  }, {
      name: 'Error',
      data: <%= data.values.map {|e| e.select(&:error?).count} %>
  }]

};

$(function() {
  Highcharts.chart('chart_number_requests', chart_number_requests);
  Highcharts.chart('chart_average_duration', chart_average_duration);
});
